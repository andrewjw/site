---
layout: post
title: Dynamic Initial Values in Django Forms
date: 2009-01-28 13:33:14.000000000 +00:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- web development
tags:
- django
- forms
meta:
  _edit_last: '364050'
author:
  login: andrewjw
  email: andrewjwilkinson@gmail.com
  display_name: Andrew Wilkinson
  first_name: Andrew
  last_name: Wilkinson
permalink: "/2009/01/28/dynamic-initial-values-in-django-forms/"
---
<p>I recently had cause to create a form with two date time fields which had the default values of midnight seven days ago, and midnight this morning. Initially I thought this would be easy and created the following form.</p>
<pre>
from datetime import datetime, date, timedelta

class MyForm(forms.Form):
    date_from = forms.DateTimeField(label="From",
                               initial=(date.today() - timedelta(days=7)))
    date_to = forms.DateTimeField(label="To", initial=date.today())
</pre>
<p>This works fine except that when a process has been running across more than one day the initial values are no longer correct as they refer to the day the process started. Fortunately it appears that there is an undocumented feature where the initial value can be a function rather than an absolute value. This function is called each time the unbound form is displayed, so they are always correct.</p>
<p>Wrapping the code to create the value in a <tt>lambda</tt> works great here, as does passing a reference to a function.</p>
<pre>
from datetime import datetime, date, timedelta

class MyForm(forms.Form):
    date_from = forms.DateTimeField(label="From",
                 initial=lambda: (date.today() - timedelta(days=7)))
    date_to = forms.DateTimeField(label="To", initial=date.today)
</pre>
